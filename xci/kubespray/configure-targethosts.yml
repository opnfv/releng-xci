---
- hosts: all
  remote_user: root
  tasks:
    - name: add public key to host
      copy:
        src: ../file/authorized_keys
        dest: /root/.ssh/authorized_keys
    - name: install dbus and ptyhon-netaddr
      apt:
        name: "{{item}}"
        update_cache: yes
      with_items:
        - "python-netaddr"
        - "dbus"

- hosts: controller
  remote_user: root
  vars_files:
    - ../var/opnfv.yml
  pre_tasks:
    - name: Load distribution variables
      include_vars:
        file: ../var/{{ ansible_os_family }}.yml
  roles:
    - role: haproxy
      when:  XCI_FLAVOR == 'ha'
