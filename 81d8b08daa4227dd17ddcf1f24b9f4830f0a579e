{
  "comments": [
    {
      "key": {
        "uuid": "5a3f45e8_a7d77dec",
        "filename": "xci/scripts/libvirt_snapshot.sh",
        "patchSetId": 3
      },
      "lineNbr": 11,
      "author": {
        "id": 5473
      },
      "writtenOn": "2018-04-04T14:15:05Z",
      "side": 1,
      "message": "I still don\u0027t understand what this variable is for. My guess is that it tries to guess what kind of VMs we need to manage. This sounds like a constant to me so maybe use \u0027declare -r\u0027 ?",
      "range": {
        "startLine": 11,
        "startChar": 0,
        "endLine": 11,
        "endChar": 114
      },
      "revId": "81d8b08daa4227dd17ddcf1f24b9f4830f0a579e",
      "serverId": "bbac25d2-bf60-4904-9ba8-a72fc000d6c5",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5a3f45e8_aa9461e2",
        "filename": "xci/scripts/libvirt_snapshot.sh",
        "patchSetId": 3
      },
      "lineNbr": 11,
      "author": {
        "id": 6895
      },
      "writtenOn": "2018-04-05T08:44:31Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "5a3f45e8_a7d77dec",
      "range": {
        "startLine": 11,
        "startChar": 0,
        "endLine": 11,
        "endChar": 114
      },
      "revId": "81d8b08daa4227dd17ddcf1f24b9f4830f0a579e",
      "serverId": "bbac25d2-bf60-4904-9ba8-a72fc000d6c5",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5a3f45e8_e72fc5f4",
        "filename": "xci/scripts/libvirt_snapshot.sh",
        "patchSetId": 3
      },
      "lineNbr": 119,
      "author": {
        "id": 5473
      },
      "writtenOn": "2018-04-04T14:15:05Z",
      "side": 1,
      "message": "this \u0027fake\u0027 threading thing looks a bit fragile to me. Do we really need to bother with threading all these operations? Did you ever compare the sequential with the threaded approach to see how much we benefit from it? I personally think that doing everything in sequence is fine for the work we do.",
      "range": {
        "startLine": 52,
        "startChar": 0,
        "endLine": 119,
        "endChar": 1
      },
      "revId": "81d8b08daa4227dd17ddcf1f24b9f4830f0a579e",
      "serverId": "bbac25d2-bf60-4904-9ba8-a72fc000d6c5",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5a3f45e8_eabdc969",
        "filename": "xci/scripts/libvirt_snapshot.sh",
        "patchSetId": 3
      },
      "lineNbr": 119,
      "author": {
        "id": 6895
      },
      "writtenOn": "2018-04-05T08:44:31Z",
      "side": 1,
      "message": "Shouldn\u0027t it have good performance since the virsh operations are running in parallel for each VM ? I remember Nikolas (original author of this code) even mentioned about this. Nikolas, Can you comment on this ?",
      "parentUuid": "5a3f45e8_e72fc5f4",
      "range": {
        "startLine": 52,
        "startChar": 0,
        "endLine": 119,
        "endChar": 1
      },
      "revId": "81d8b08daa4227dd17ddcf1f24b9f4830f0a579e",
      "serverId": "bbac25d2-bf60-4904-9ba8-a72fc000d6c5",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5a3f45e8_0a72b5e4",
        "filename": "xci/scripts/libvirt_snapshot.sh",
        "patchSetId": 3
      },
      "lineNbr": 119,
      "author": {
        "id": 5473
      },
      "writtenOn": "2018-04-05T08:53:08Z",
      "side": 1,
      "message": "yeah OK it might save us a few minutes but does it really worth it to make it this complex? it\u0027s not like we try to manage 100s of VMs. In the most complex scenario we only have 6 VMs",
      "parentUuid": "5a3f45e8_eabdc969",
      "range": {
        "startLine": 52,
        "startChar": 0,
        "endLine": 119,
        "endChar": 1
      },
      "revId": "81d8b08daa4227dd17ddcf1f24b9f4830f0a579e",
      "serverId": "bbac25d2-bf60-4904-9ba8-a72fc000d6c5",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5a3f45e8_5b96514d",
        "filename": "xci/scripts/libvirt_snapshot.sh",
        "patchSetId": 3
      },
      "lineNbr": 119,
      "author": {
        "id": 6895
      },
      "writtenOn": "2018-04-06T09:00:47Z",
      "side": 1,
      "message": "Yes, But Let us wait to hear back from Nikolas.",
      "parentUuid": "5a3f45e8_0a72b5e4",
      "range": {
        "startLine": 52,
        "startChar": 0,
        "endLine": 119,
        "endChar": 1
      },
      "revId": "81d8b08daa4227dd17ddcf1f24b9f4830f0a579e",
      "serverId": "bbac25d2-bf60-4904-9ba8-a72fc000d6c5",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5a3f45e8_86c5193e",
        "filename": "xci/scripts/libvirt_snapshot.sh",
        "patchSetId": 3
      },
      "lineNbr": 119,
      "author": {
        "id": 6895
      },
      "writtenOn": "2018-04-09T15:16:06Z",
      "side": 1,
      "message": "Moved into single threaded to make it more simple as hwoarang mentioned. \n\nI\u0027m seeing some intermittent issues while doing snapshots import with following errors. Will debug into it.\n\nopnfv_epalper@pod1-blade05:~/releng-xci/xci/scripts$ ./xci_snapshot.sh import ~/virsh-export/xci_export_2018-04-09_13_56_45.tar.gz\n\n~/import_untar ~/releng-xci/xci/scripts\n\n\n\nnodes\n/var/lib/libvirt/images/opnfv.qcow2\n\n/var/lib/libvirt/images/controller00.qcow2\n/var/lib/libvirt/images/compute00.qcow2\nopnfv/\nopnfv/current\nopnfv/snapshot_xml_export_2018-04-09_13_51_01\nopnfv/snapshots\nopnfv/xml\nopnfv/disk_path\ncontroller00/\ncontroller00/current\ncontroller00/snapshot_xml_export_2018-04-09_13_51_01\ncontroller00/snapshots\ncontroller00/xml\ncontroller00/disk_path\ncompute00/\ncompute00/current\ncompute00/snapshot_xml_export_2018-04-09_13_51_01\ncompute00/snapshots\ncompute00/xml\ncompute00/disk_path\nnodes\ntar: nodes: Cannot open: File exists\ntar: Exiting with failure status due to previous errors\n~/releng-xci/xci/scripts\nDomain opnfv defined from /tmp/xml\n\nerror: XML error: memory state cannot be saved with offline or disk-only snapshot\n\nDomain controller00 defined from /tmp/xml\n\nerror: XML error: memory state cannot be saved with offline or disk-only snapshot\n\nDomain compute00 defined from /tmp/xml\n\nerror: XML error: memory state cannot be saved with offline or disk-only snapshot\nopnfv_epalper@pod1-blade05:~/releng-xci/xci/scripts$ virsh list --all\n Id    Name                           State\n----------------------------------------------------\n -     compute00                      shut off\n -     controller00                   shut off\n -     opnfv                          shut off",
      "parentUuid": "5a3f45e8_5b96514d",
      "range": {
        "startLine": 52,
        "startChar": 0,
        "endLine": 119,
        "endChar": 1
      },
      "revId": "81d8b08daa4227dd17ddcf1f24b9f4830f0a579e",
      "serverId": "bbac25d2-bf60-4904-9ba8-a72fc000d6c5",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5a3f45e8_4737994e",
        "filename": "xci/scripts/libvirt_snapshot.sh",
        "patchSetId": 3
      },
      "lineNbr": 181,
      "author": {
        "id": 5473
      },
      "writtenOn": "2018-04-04T14:15:05Z",
      "side": 1,
      "message": "this function implies that it returns something. So the best way to code that would be to actually make _snapshots a local variable and use \u0027return\u0027 to actually return it.",
      "revId": "81d8b08daa4227dd17ddcf1f24b9f4830f0a579e",
      "serverId": "bbac25d2-bf60-4904-9ba8-a72fc000d6c5",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5a3f45e8_cac0cde2",
        "filename": "xci/scripts/libvirt_snapshot.sh",
        "patchSetId": 3
      },
      "lineNbr": 181,
      "author": {
        "id": 6895
      },
      "writtenOn": "2018-04-05T08:44:31Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "5a3f45e8_4737994e",
      "revId": "81d8b08daa4227dd17ddcf1f24b9f4830f0a579e",
      "serverId": "bbac25d2-bf60-4904-9ba8-a72fc000d6c5",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5a3f45e8_273a4d36",
        "filename": "xci/scripts/libvirt_snapshot.sh",
        "patchSetId": 3
      },
      "lineNbr": 193,
      "author": {
        "id": 5473
      },
      "writtenOn": "2018-04-04T14:15:05Z",
      "side": 1,
      "message": "this is a magic variable. It\u0027s best to consume what get_snapshots() returns to you",
      "range": {
        "startLine": 193,
        "startChar": 17,
        "endLine": 193,
        "endChar": 30
      },
      "revId": "81d8b08daa4227dd17ddcf1f24b9f4830f0a579e",
      "serverId": "bbac25d2-bf60-4904-9ba8-a72fc000d6c5",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5a3f45e8_2ab85175",
        "filename": "xci/scripts/libvirt_snapshot.sh",
        "patchSetId": 3
      },
      "lineNbr": 193,
      "author": {
        "id": 6895
      },
      "writtenOn": "2018-04-05T08:44:31Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "5a3f45e8_273a4d36",
      "range": {
        "startLine": 193,
        "startChar": 17,
        "endLine": 193,
        "endChar": 30
      },
      "revId": "81d8b08daa4227dd17ddcf1f24b9f4830f0a579e",
      "serverId": "bbac25d2-bf60-4904-9ba8-a72fc000d6c5",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5a3f45e8_874081a6",
        "filename": "xci/scripts/libvirt_snapshot.sh",
        "patchSetId": 3
      },
      "lineNbr": 332,
      "author": {
        "id": 5473
      },
      "writtenOn": "2018-04-04T14:15:05Z",
      "side": 1,
      "message": "whitespace",
      "range": {
        "startLine": 332,
        "startChar": 51,
        "endLine": 332,
        "endChar": 52
      },
      "revId": "81d8b08daa4227dd17ddcf1f24b9f4830f0a579e",
      "serverId": "bbac25d2-bf60-4904-9ba8-a72fc000d6c5",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5a3f45e8_0abbd572",
        "filename": "xci/scripts/libvirt_snapshot.sh",
        "patchSetId": 3
      },
      "lineNbr": 332,
      "author": {
        "id": 6895
      },
      "writtenOn": "2018-04-05T08:44:31Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "5a3f45e8_874081a6",
      "range": {
        "startLine": 332,
        "startChar": 51,
        "endLine": 332,
        "endChar": 52
      },
      "revId": "81d8b08daa4227dd17ddcf1f24b9f4830f0a579e",
      "serverId": "bbac25d2-bf60-4904-9ba8-a72fc000d6c5",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5a3f45e8_a745bdb4",
        "filename": "xci/scripts/libvirt_snapshot.sh",
        "patchSetId": 3
      },
      "lineNbr": 408,
      "author": {
        "id": 5473
      },
      "writtenOn": "2018-04-04T14:15:05Z",
      "side": 1,
      "message": "whitespace",
      "range": {
        "startLine": 408,
        "startChar": 77,
        "endLine": 408,
        "endChar": 78
      },
      "revId": "81d8b08daa4227dd17ddcf1f24b9f4830f0a579e",
      "serverId": "bbac25d2-bf60-4904-9ba8-a72fc000d6c5",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5a3f45e8_6ab1b98e",
        "filename": "xci/scripts/libvirt_snapshot.sh",
        "patchSetId": 3
      },
      "lineNbr": 408,
      "author": {
        "id": 6895
      },
      "writtenOn": "2018-04-05T08:44:31Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "5a3f45e8_a745bdb4",
      "range": {
        "startLine": 408,
        "startChar": 77,
        "endLine": 408,
        "endChar": 78
      },
      "revId": "81d8b08daa4227dd17ddcf1f24b9f4830f0a579e",
      "serverId": "bbac25d2-bf60-4904-9ba8-a72fc000d6c5",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5a3f45e8_e716a5a6",
        "filename": "xci/scripts/libvirt_snapshot.sh",
        "patchSetId": 3
      },
      "lineNbr": 417,
      "author": {
        "id": 5473
      },
      "writtenOn": "2018-04-04T14:15:05Z",
      "side": 1,
      "message": "why do you use \u0027set -x\u0027 on every case? why do we need that?",
      "range": {
        "startLine": 417,
        "startChar": 6,
        "endLine": 417,
        "endChar": 12
      },
      "revId": "81d8b08daa4227dd17ddcf1f24b9f4830f0a579e",
      "serverId": "bbac25d2-bf60-4904-9ba8-a72fc000d6c5",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5a3f45e8_4aacbd35",
        "filename": "xci/scripts/libvirt_snapshot.sh",
        "patchSetId": 3
      },
      "lineNbr": 417,
      "author": {
        "id": 6895
      },
      "writtenOn": "2018-04-05T08:44:31Z",
      "side": 1,
      "message": "I think it was done for debugging purpose. removed it now.",
      "parentUuid": "5a3f45e8_e716a5a6",
      "range": {
        "startLine": 417,
        "startChar": 6,
        "endLine": 417,
        "endChar": 12
      },
      "revId": "81d8b08daa4227dd17ddcf1f24b9f4830f0a579e",
      "serverId": "bbac25d2-bf60-4904-9ba8-a72fc000d6c5",
      "unresolved": false
    }
  ]
}